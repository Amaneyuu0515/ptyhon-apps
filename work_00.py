# ここで、テキストを表示する関数を定義する。
# メッセージの前に絵文字（👤）を付けて表示。
# ユーザーが Enter を押すまで待機（続きを読み進める形式）。
def chat_line(text):
    print(f"\n👤 {text}")
    input("▶︎（続けるにはEnter）")


# # ここで、選択肢を表示し、ユーザーの入力を受け取る関数を定義する。
# 処理の流れ
# options（選択肢のリスト）を番号付きで表示。
# ユーザーに選択肢番号を入力させる。
# 数値で、かつ範囲内ならその番号に対応するテキストを返す。
# それ以外ならエラーメッセージを出して再入力を促す。
def choice(options):
    for i, opt in enumerate(options, 1):
        print(f"{i}. {opt}")
    while True:
        sel = input("選択肢番号を入力 > ")
        if sel.isdigit() and 1 <= int(sel) <= len(options):
            return int(sel)
        else:
            print("正しい番号を入力してください。もう一度試してみましょう。")


# ここからゲームのメイン関数を定義し、シナリオを作る。
def main():
    print("=== 選択式チャットゲーム ===")
    chat_line("とある王国、あなたはその王国の一般人だった。")
    chat_line("ある日、王様から城へと呼び出された。")
    chat_line("王様「よくぞ来てくれた、勇者の資格を持つものよ。」")
    chat_line("王様「お主はこの世界を救う旅に出る覚悟はあるか？」")
    chat_line("あなた「、、、え？俺が？」")
    chat_line("王様「そうだ、魔王が世界を脅かしている。")
    chat_line("王様「お主の力が必要なのだ。」")

    ans = choice(["はい", "いいえ"])

    if ans == 1:
        chat_line("あなた「、、、よくわかりませんが、わかりました。」")
        chat_line("王様「素晴らしい…その勇気、しかと見届けた。」")
        chat_line("王様「では、まずは北の森へ向かうがよい。」")
        chat_line("王様から剣と盾を受け取り、あなたは旅立つことになった。")
        chapter2()
    else:
        chat_line("あなた「、、、嫌です、俺は争いが嫌いな一般人なので。」")
        chat_line("王様「……そうか。勇なき者に未来はない。」")
        chat_line("王様「ここで終わりだ。衛兵よ、此奴を捕らえよ！")
        chat_line("あなたは王へ反逆したとされ処刑されてしまった。")
        bad_ending()


# ここからは各章の関数を定義する。
def chapter2():
    chat_line("あなたは北の森の入り口にたどり着いた。")
    chat_line("森は暗く静かで、どこか不気味な雰囲気が漂っている。")
    chat_line("森を歩いていると、笛の演奏が聞こえてくる...。")
    chat_line("あなた「、、、誰かいるのか？」")
    chat_line("そこにいたのはエルフの少女だった")
    chat_line("エルフの少女「あなたは誰？この森になんのよう？」")
    chat_line(
        "あなた「、、、一応勇者らしいんだけど、、めんどくさい人（王様）に言われてここまできただけだよ。」"
    )
    chat_line("エルフの少女「そうなんだ。私はこの森の盟主、リリアンヌよ」")
    chat_line("リリアンヌ「この森は魔物が多くて危険だから、私が案内しましょうか？」")

    ans = choice(["彼女の話を素直に聞く", "無視して進む"])

    if ans == 1:
        chat_line("あなた「、、、ありがとう。助かるよ。」")
        chat_line("リリアンヌ「わかった、私についてきて。」")
        chat_line("あなたは少女と共に森へ踏み出した。")
        chat_line("深い霧の中、魔物の気配が近づいてくる――。")
        chapter3_with_girl()
    else:
        chat_line("あなた「、、、別に案内なんていらないよ。」")
        chat_line("リリアンヌ「そう、でも、気をつけて」")
        chat_line("あなたは少女を無視して森に入った。")
        chat_line("足元に気を取られていると、突然背後から何かが襲いかかってきた――！")
        chat_line("あなた「！！」")
        chat_line("魔物『ガアアア……！』")
        bad_ending()


def chapter3_with_girl():
    chat_line("あなたとリリアンヌは森の奥へと進んでいった。")
    chat_line("リリアンヌ「この森には魔物がたくさんいるの。」")
    chat_line("リリアンヌ「でも、私の魔法で守ってあげるから安心して。」")
    chat_line("あなた「、、、ありがとう。優しいな」")
    chat_line("リリアンヌ「別に、、、(///)」")
    chat_line("森の奥へ進むほどどんどん霧が濃くなっていく")
    chat_line("リリアンヌ「ここから先は特に危険よ。気をつけて。」")
    chat_line("あなたはリリアンヌと共に森を進んでいく。")
    chat_line("森の奥に黒くうごめく獣が現れた。")

    ans = choice(["逃げる", "攻撃する"])

    if ans == 1:
        chat_line("あなた「、、、戦いたくないし、逃げよう」")
        chat_line("リリアンヌ「えっ、魔物を見逃すの？」")
        chat_line("あなた「、、、魔物にも魔物の暮らしがあるんだし」")
        chat_line("リリアンヌ「でも、魔物は人間を襲うこともあるのよ？」")
        chat_line("あなた「、、、それはそうだけど、なんか、可哀想じゃん？」")
        chat_line("リリアンヌ「、、、でも」")
        chat_line("あなた「、、、俺は戦いが嫌いなんだ、だから逃げよう」")
        chat_line("リリアンヌ「、、、わかった、あなたの意見を尊重するわ。」")
        chat_line("あなたとリリアンヌは魔物を避けて森を進んでいく。")
        chat_line("あなたたちは無事に森を抜けることができた。")
        chapter4()
    else:
        chat_line("あなた「、、、自分でやるから、下がってて。」")
        chat_line("リリアンヌ「まって！危険よ！私の魔法で助けるから！」")
        chat_line("あなたはリリアンヌの言葉を無視して、魔物に向かって突進した。")
        chat_line("あなたは剣を抜いて突撃した！")
        chat_line("だが魔物の力は強く、吹き飛ばされてしまう…！")
        chat_line("あなた「ぐっ、、」")
        chat_line("リリアンヌ「大丈夫？！」")
        chat_line("あなたは倒れ込み、意識が遠のいていく。")
        chat_line("リリアンヌ「私がなんとかするから、頑張って！」")
        chat_line("リリアンヌは魔法を唱え、あなたを守るために魔物と戦い始めた。")
        chat_line(
            "少女は魔法でなんとか魔物を退けたが、あなたの受けた傷は致命傷となってしまった。"
        )
        bad_ending()


def chapter4():
    chat_line("あなたとリリアンヌは森を抜け、広い平原に出た。")
    chat_line("リリアンヌ「ここまで来れば、もう安心よ。」")
    chat_line("あなた「、、、ありがとう、リリアンヌ。」")
    chat_line("リリアンヌ「でも、まだ魔王が待っているわ。」")
    chat_line("あなた「、、、魔王、か」")
    chat_line("リリアンヌ「ん？どうかしたの？」")
    chat_line("あなた「いや、なんでもないよ。早く行こうか」")
    chat_line("リリアンヌ「でも、さっきの戦いで疲れたでしょう？」")
    chat_line("リリアンヌ「少し休んでから進むのはどう？」")
    ans = choice(["休む", "すぐに進む"])

    if ans == 1:
        chat_line("あなたはリリアンヌの提案を受け入れ、少し休むことにした。")
        chat_line("あなた「、、、そうだね、少し休もうか」")
        chat_line("リリアンヌ「よかった、少しでも体力を回復させないと。」")
        chat_line("あなたはリリアンヌと共に草むらで休息を取った。")
        chat_line("リリアンヌ「準備ができたら、魔王の城へ向かいましょう。」")
        chat_line("あなたはリリアンヌと共に魔王の城へ向かう決意を固めた。")
        chapter5()
    else:
        chat_line("あなたはすぐに進むことを決意した。")
        chat_line("あなた「、、、休んでる暇はない、、すぐに進もう」")
        chat_line("リリアンヌ「でも、疲れているでしょう？無理はしないで。」")
        chat_line("あなた「大丈夫だよ、俺はまだ行ける。」")
        chat_line("リリアンヌ「、、、わかった、あなたの意志を尊重するわ。」")
        chat_line("あなたはリリアンヌと共に魔王の城へ向かうことにした。")
        chat_line("しかし、疲れが溜まっていた所に魔物が現れた。")
        chat_line("あなたは疲れ切っていて、まともに戦うことができなかった。")
        bad_ending()


def chapter5():
    chat_line("あなたとリリアンヌは苦難の末魔王の城へと向かった。")
    chat_line("城の門は大きく、魔王の威圧感が漂っている。")
    chat_line("リリアンヌ「ここが魔王の城よ。」")
    chat_line("リリアンヌ「魔王は強力な魔物を従えているから、気をつけて。」")
    chat_line("あなた「、、、わかった。リリアンヌ、いつも通り頼むよ。」")
    chat_line("リリアンヌ「えぇ、あなた、（左手の指輪が少しきらつく）」")
    chat_line("あなたはリリアンヌと共に城の中へと踏み込んだ。")
    chat_line("城の中は暗く、魔物の気配が漂っている。")
    chat_line("あなたは剣を構え、リリアンヌは魔法の準備を整えた。")
    chat_line("魔物たちが襲いかかってくる！")
    ans = choice(["魔物と戦う", "話し合う"])

    if ans == 1:
        chat_line("あなた「、、、申し訳ないけど、、来い」")
        chat_line("リリアンヌ「行きましょう」")
        chat_line("あなたとリリアンヌは魔物たちと激しい戦闘を繰り広げた。")
        chat_line("魔物たちは次々と倒されていくが、数は多い。")
        chat_line("ついに、魔王が姿を現した。")
        chat_line("魔王「人間ども、よくも、、」")
        chat_line("あなた「魔王、、やるしかないのか、、」")
        chat_line("リリアンヌ「、、、戦うしか道はないでしょ？」")
        chat_line("魔王「来い、人間ども！」")
        normal_ending()
    else:
        chat_line("あなた「、、、やっぱり、戦うの好きじゃないや、俺、、」")
        chat_line("魔物たちの前であなたは剣を下ろした。")
        chat_line("あなた「、、、話し合いで解決できないかな？」")
        chat_line("リリアンヌ「え？話し合い？戦いながら説得するんじゃ、、、？」")
        chat_line("魔物たちは一瞬戸惑ったが、あなたの真剣な眼差しに心を動かされた。")
        chat_line("そこへ魔王が現れる。")
        chat_line("魔王「人間ども、何の様だ、、」")
        chat_line("あなた「魔王、俺たちは戦いたくないんだ。」")
        chat_line("魔王「、、、ほう？」")
        chat_line(
            "あなた「俺は、魔物にも魔物の暮らしがある。初めて魔物を見た時から、そう思っていた"
        )
        chat_line(
            "リリアンヌ「、、、私も、今回の旅でそれを学べた。だって魔物が人間を襲う理由は、人間が魔物の土地を奪ったから、違う？」"
        )
        chat_line(
            "魔王「、、、その通りだ、人間どもは我らの土地を奪い、我らを迫害してきた。」"
        )
        chat_line("魔王「だから、我らは人間を滅ぼすことにしたのだ。」")
        chat_line("あなた「そっか、そういう考え方もあるのか。」")
        chat_line("リリアンヌ「あなた、、？」")
        chat_line(
            "あなた「人間が、いなければ、、魔物は平和に暮らせるのかもしれない。」"
        )
        chat_line(
            "その言葉を聞いた魔王は少し驚くが、すぐに冷静さを取り戻し、あなたに問う。"
        )
        chat_line("魔王「、、、お前は、我らの敵ではないのか？」")
        chat_line("あなた「敵じゃないよ、俺はただ、争いをなくしたいだけなんだ。」")
        chat_line("あなた「、、、争いはただ、新たな苦しみを生み出すだけだから」")
        chat_line("魔王「、、、そうか、ならば、我と共にくるが良い、」")
        chat_line("魔王「お前が望む世界を、共につくろうではないか。」")
        chat_line("リリアンヌ「、、、あなた、どうするの？」")
        chat_line(
            "あなた「、、、わかった、ただし、北の森の住民だけは手を出さないでくれ。」"
        )
        chat_line("魔王「、、、ふむ、よかろう全ての魔物に言い聞かせておく。」")
        chat_line(
            "あなたは魔王の提案を受け入れ、リリアンヌと共に魔王の元へと向かった。"
        )
        good_ending()


def good_ending():
    chat_line("🌟【エンディング：🌟【エンディング：理想のセカイ】")
    chat_line("あなた「全ては、争いのない世界のために」")
    chat_line("魔王「、、、我らは共に新しい世界を築くのだ。」")
    chat_line("魔王「全軍、突撃せよ！！」")
    chat_line("魔物たちは人間の国へと攻め込み、全てを征服した。")
    chat_line("人間はあなたと北の森に住む数人以外一人もいなくなった")
    chat_line("世界に争いはなくなり、魔物やエルフが自由に暮らせる世界となった。")
    chat_line("リリアンヌ「、、、これが、あなたの望む世界。」")
    chat_line("あなた「、、、うん、これが俺の望む世界だよ。」")
    chat_line("リリアンヌ「、、、人間がいないだけでここまで変わるものなのね。」")
    chat_line("あなた「、、、人は欲に忠実だからね、、僕も含めて。」")
    chat_line("あなたとリリアンヌは魔王と共に新しい世界を築く。")
    print("\n=== GOOD END ===")


def normal_ending():
    chat_line("🌙【エンディング：平和な日常...?】")
    chat_line(
        "王様「よくぞ魔王を倒してくれた！お主はこの世界の英雄じゃ！今宵は宴じゃ！」"
    )
    chat_line("あなた「、、、これで、魔物たちも平和に暮らせるのかな、、？」")
    chat_line("全てが平和そのものになった。ただ一つを除いて...。")
    chat_line("魔王子「、、、父さん、今そっちにいくよ、、全て、消えろ、、！」")
    chat_line("滅びは、全てに平等である")
    print("\n=== NORMAL END ===")


def bad_ending():
    chat_line("💀【エンディング：世界の崩壊】")
    chat_line("魔王「人間どもを皆殺しにしろ！我らの国を守るために！」")
    chat_line("勇者を失った世界は魔物に全てを滅ぼされた。")
    print("\n=== BAD END ===")


if __name__ == "__main__":
    main()
